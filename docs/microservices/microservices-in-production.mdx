---
<<<<<<< HEAD:pages/microservices-in-production.md
layout: default
title: プロダクション環境下でのマイクロサービス
permalink: /microservices-in-production/
sitemap:
    priority: 0.7
    lastmod: 2020-09-11T00:00:00-00:00
---

# <i class="fa fa-cloud"></i> プロダクション環境下でのマイクロサービス

マイクロサービスは、特定の種類のJHipsterアプリケーションです。プロダクションビルドの実行、最適化、およびセキュリティ保護の詳細については、メインの[プロダクション環境下でのJHipsterのドキュメント]({{ site.url }}/production)を参照してください。

<h2 id="elk">マイクロサービスの監視</h2>

JHipsterレジストリを使用する場合、使用可能なランタイムダッシュボードとその使用方法については、[JHipsterレジストリのドキュメント]({{ site.url }}/jhipster-registry)を参照してください。

[モニタリングのドキュメント]({{ site.url }}/monitoring)も非常に重要であり、以下の使用に関する具体的な情報を得ることができます。
=======
title: Microservices in production
slug: /microservices-in-production/
last_update:
  date: 2020-09-11T00:00:00-00:00
---

Microservices are a specific kind of JHipster applications. Please refer to our main [Using JHipster in production documentation](/production) for more information on doing a production build, optimizing it and securing it.


## Microservices monitoring

If using JHipster Registry, please refer to our [JHipster Registry documentation](/jhipster-registry) for learning which runtime dashboards are available, and how to use them.

Our [monitoring documentation](/monitoring) is also very important, to learn specific information on using:
>>>>>>> be9dc09c024a35e21e9637afdb55a6d53991f8d2:docs/microservices/microservices-in-production.mdx

- マイクロサービスのログを収集するELK
- マイクロサービスのメトリクスを収集するPrometheus
- サービス全体のHTTP要求をトレースするZipkin

<<<<<<< HEAD:pages/microservices-in-production.md
<h2 id="docker_compose">Docker Composeを使用した開発とデプロイ</h2>
=======

## Using Docker Compose to develop and deploy
>>>>>>> be9dc09c024a35e21e9637afdb55a6d53991f8d2:docs/microservices/microservices-in-production.mdx

マイクロサービスアーキテクチャで作業するということは、複数の異なるサービスとデータベースを連携させる必要があるということであり、その意味でDocker Composeは、開発、テスト、運用環境を管理するための優れたツールです。

<<<<<<< HEAD:pages/microservices-in-production.md
マイクロサービスに関する特定のセクションは、[Docker Composeドキュメント]({{ site.url }}/docker-compose#microservices)に含まれており、マイクロサービスアーキテクチャに取り組む際には、このセクションに精通することを強くお勧めします。

Docker SwarmはDocker Machineと同じAPIを使用しているため、クラウドにマイクロサービスアーキテクチャをデプロイすることは、ローカルマシンにデプロイすることとまったく同じです。JHipsterでDocker Composeを使用する方法の詳細については、[Docker Composeドキュメント]({{ site.url }}/docker-compose/)に従ってください。

<h2 id="cloudfoundry">Cloud Foundryによる本番環境への移行</h2>

[Cloud Foundryサブジェネレータ]({{ site.url }}/cloudfoundry/)は、マイクロサービスアーキテクチャでも同じように動作しますが、主な違いは、デプロイするアプリケーションがより多いことです。

- [Cloud Foundryサブジェネレータ]({{ site.url }}/cloudfoundry/)を使用して、最初にJHipsterレジストリ（通常のJHipsterアプリケーション）をデプロイします。
- JHipsterレジストリがデプロイされているURLをメモします。アプリケーションはすべてそのURLを指している必要があります。
  - `bootstrap-prod.yml`ファイルでは、`spring.cloud.config.uri`は`http(s)://<your_jhipster_registry_url>/config/`を指している必要があります。
  - `application-prod.yml`ファイルでは、`eureka.client.serviceUrl.defaultZone`は`http(s)://<your_jhipster_registry_url>/eureka/`を指している必要があります。
- ゲートウェイとマイクロサービスをデプロイします。
- Cloud Foundryを使用して、アプリケーションを通常どおりにスケールアップします。
=======
A specific section on microservices is included in our [Docker Compose documentation](/docker-compose#microservices), and we highly recommend that you get familiar with it when working on a microservices architecture.

As Docker Swarm uses the same API as Docker Machine, deploying your microservices architecture in the cloud is exactly the same as deploying it on your local machine. Follow our [Docker Compose documentation](/docker-compose) to learn more about using Docker Compose with JHipster.


## Going to production with Cloud Foundry

The [Cloud Foundry sub-generator](/cloudfoundry) works the same with a microservices architecture, the main difference is that you have more applications to deploy:

- Use the [Cloud Foundry sub-generator](/cloudfoundry) to deploy first the JHipster Registry (which is a normal JHipster application).
- Note the URL on which your JHipster Registry is deployed. Your applications must all point to that URL:
  - In the `bootstrap-prod.yml` file, the `spring.cloud.config.uri` must point to `http(s)://<your_jhipster_registry_url>/config/`
  - In the `application-prod.yml` file, the `eureka.client.serviceUrl.defaultZone` must point to `http(s)://<your_jhipster_registry_url>/eureka/`
- Deploy your gateway(s) and microservices
- Scale your applications as usual with Cloud Foundry
>>>>>>> be9dc09c024a35e21e9637afdb55a6d53991f8d2:docs/microservices/microservices-in-production.mdx

覚えておくべき重要な点の1つは、JHipsterレジストリはデフォルトでは保護されておらず、マイクロサービスは外部からアクセスできないことになっていることです。ユーザはゲートウェイを使用してアプリケーションにアクセスすることになります。

この問題を解決するには、次の2つの方法があります。

- 特定のルートを使用してCloud Foundryを保護します。
- すべてを公開したまま、すべての場所でHTTPSを使用し、Spring Securityの基本認証サポートを使用してJHipsterレジストリを保護します。

<<<<<<< HEAD:pages/microservices-in-production.md
<h2 id="heroku">Herokuを使用した本番環境への移行</h2>

[Herokuサブジェネレータ]({{ site.url }}/heroku/)は、マイクロサービスアーキテクチャとほぼ同じように動作しますが、主な違いは、デプロイするアプリケーションがより多いことです。
=======

## Going to production with Heroku

The [Heroku sub-generator](/heroku) works nearly the same with a microservices architecture, the main difference is that you have more applications to deploy:
>>>>>>> be9dc09c024a35e21e9637afdb55a6d53991f8d2:docs/microservices/microservices-in-production.mdx

ワンクリックでJHipsterレジストリを直接デプロイします。

[![Herokuへのデプロイ](https://camo.githubusercontent.com/c0824806f5221ebb7d25e559568582dd39dd1170/68747470733a2f2f7777772e6865726f6b7563646e2e636f6d2f6465706c6f792f627574746f6e2e706e67)](https://dashboard.heroku.com/new?&template=https%3A%2F%2Fgithub.com%2Fjhipster%2Fjhipster-registry)

<<<<<<< HEAD:pages/microservices-in-production.md
JHipsterレジストリをセキュアにする方法を理解するには、[Herokuサブジェネレータのドキュメント]({{ site.url }}/heroku/)に従ってください。
=======
Please follow the [Heroku sub-generator documentation](/heroku) in order to understand how to secure your JHipster Registry.
>>>>>>> be9dc09c024a35e21e9637afdb55a6d53991f8d2:docs/microservices/microservices-in-production.mdx

JHipsterレジストリがデプロイされているURLをメモします。アプリケーションはすべて、`application-prod.yml`ファイルでそのURLを指定する必要があります。その構成を次のように変更します。

```yaml
eureka:
    instance:
        hostname: https://admin:[password]@[appname].herokuapp.com
        prefer-ip-address: false
```

これで、ゲートウェイとマイクロサービスをデプロイし、スケールができます。Herokuのサブジェネレータは、JHipsterレジストリのURLを知るために、新しい質問をします。これにより、アプリケーションはSpring Cloud Configサーバで設定を取得できるようになります。
