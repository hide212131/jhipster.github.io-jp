# JHipster Japanese Website

**Always follow these instructions exactly. Only search for additional information or use bash commands if the instructions below are incomplete or found to be incorrect.**

The JHipster Japanese website is a Jekyll-based static site that provides Japanese documentation for JHipster. It's deployed via GitHub Pages and is a fork of the main jhipster.github.io repository.

## Working Effectively

### Prerequisites and Installation
- Install Ruby 3.2+ and run: `sudo gem install bundler`
- Install Node.js 20+ with npm
- Install dependencies: `npm install && bundle install`
  - NEVER CANCEL: npm install takes 3+ minutes. Set timeout to 10+ minutes.  
  - NEVER CANCEL: bundle install takes 2+ minutes. Set timeout to 10+ minutes.

### Building and Running
- Build the site: `bundle exec jekyll build`
  - NEVER CANCEL: Build takes 15+ seconds. Set timeout to 5+ minutes.
  - Generates ~120MB static site in `_site/` directory
- Run development server: `bundle exec jekyll serve --host=0.0.0.0 --port=4000`
  - NEVER CANCEL: Server startup takes 15+ seconds. Set timeout to 5+ minutes.
  - Alternative: `npm start` (same as above but uses npm script)
  - Access at http://localhost:4000 or http://0.0.0.0:4000
  - Auto-regenerates content on file changes
- Compile SCSS to CSS: `npm run sass`
  - Takes ~1 second, produces updated CSS files in `/css/`

### Validation and Testing  
- **CRITICAL**: Always test the complete website functionality after making changes:
  1. Build the site: `bundle exec jekyll build`
  2. Start server: `bundle exec jekyll serve --host=0.0.0.0 --port=4000`  
  3. Access http://localhost:4000 and verify:
     - Home page loads correctly
     - Japanese text displays properly
     - CSS styles apply correctly
     - Navigation links work
     - At least one tips page loads: http://localhost:4000/tips
- Run Japanese text linting: `npx textlint [file.md]`
  - Takes ~2 seconds per file
  - Uses rules in `.textlintrc.json` for Japanese technical writing
- Clean previous builds: `sudo rm -rf _site` (if permission issues occur)

## Common Tasks

### Making Content Changes
- Always edit source files, never edit `_site/` (generated directory)
- Markdown content: Edit `.md` files in root and subdirectories
- Styling: Edit `.scss` files in `/css/scss/`, then run `npm run sass`
- Always test changes with the validation steps above

### Build Issues
- If Jekyll build fails with YAML errors, check markdown frontmatter syntax
- Known issue: `tips/026_tip_issue_of_onetoone_with_mapsid_how_to_avoid_it.md` has YAML parsing error (non-critical)
- If permission errors on `_site/`: run `sudo rm -rf _site` then rebuild
- If bundle install fails: run with `sudo gem install bundler` first

### Docker (NOT RECOMMENDED)
- `docker compose up` - Docker setup exists but FAILS due to gem compatibility issues
- Use native Jekyll installation instead

### DO NOT USE
- `npm run images` - FAILS due to gulp-imagemin import issues (not critical for functionality)
- Docker setup - has gem dependency conflicts

## Repository Structure

### Key Directories
```
/css/scss/          # SCSS source files (edit these)
/css/               # Compiled CSS (generated by npm run sass)  
/_site/             # Generated static site (do not edit)
/tips/              # Tips and tutorials content
/_posts/            # Blog posts  
/_layouts/          # Jekyll page templates
/_includes/         # Jekyll partial templates
/.github/workflows/ # CI/CD automation
```

### Key Files
```
README.md           # Basic setup instructions (Japanese)
package.json        # npm dependencies and scripts  
Gemfile            # Ruby gem dependencies
_config.yml        # Jekyll configuration
.textlintrc.json   # Japanese text linting rules
gulpfile.js        # Build automation tasks
docker-compose.yml # Docker setup (broken, don't use)
```

### Common File Outputs
```bash
# Repository root listing
ls -la
.github/           .textlintrc.json   _includes/         companies-using-jhipster/
.gitignore         404.md             _layouts/          css/
.bundle/           CNAME              _posts/            docker-compose.yml
Gemfile            JHipster-*.md      blueprints/        favicon.ico
LICENSE            README.md          _config.yml        gulpfile.js
package.json       _site/             images/            tips/
```

### GitHub Workflows
- `sync-upstream.yml` - Syncs with main jhipster.github.io repository  
- `merge-main-to-gh-pages.yml` - Deploys to GitHub Pages
- `copyright-update.yml` - Automated copyright updates

## Timing Expectations
- Initial setup (npm install + bundle install): 5+ minutes
- Jekyll build: 15+ seconds  
- Jekyll serve startup: 15+ seconds
- SCSS compilation: 1 second
- Text linting: 2+ seconds per file
- **NEVER CANCEL these operations** - they may appear to hang but are processing

## Troubleshooting
- Server not starting: Check if port 4000 is available
- Build failures: Clean `_site/` directory and rebuild
- Gem issues: Ensure Ruby 3.2+ and latest bundler
- npm issues: Ensure Node.js 20+ and latest npm
- CSS not updating: Run `npm run sass` after SCSS changes
- Always set appropriate timeouts (5+ minutes for builds, 10+ minutes for installs)